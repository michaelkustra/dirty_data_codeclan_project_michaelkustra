---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(here)
```

#read in clean data 
```{r}
long_clean_candy_data <- read_csv(here("clean_data/long_combined_clean_data.csv"))
```


#dimensions of clean data set
```{r}

dim(long_clean_candy_data)

```

# Question 1
# What is the total number of candy ratings given across the three years. (Number of candy ratings, not the number of raters. Donâ€™t count missing values)

```{r}

long_clean_candy_data %>% 
  select(ratings) %>% 
  summarise(total_num_ratings = sum(!is.na(ratings)))

```

The total number of candy ratings across the three years (excluding any NAs)
was 615789!

# Question 2
# What was the average age of people who are going out trick or treating?


```{r}

long_clean_candy_data %>% 
  select(going_out) %>% 
  distinct()
```

```{r}

long_clean_candy_data %>% 
  filter(going_out == "Yes") %>%
  summarise(avg_age_trick_treater = mean(age, na.rm = TRUE))

```

The average age for someone who went out trick or treating is 35.09 years (2dp).

# Question 3
# What was the average age of people who are not going trick or treating?

```{r}

long_clean_candy_data %>% 
  filter(going_out == "No") %>% 
  summarise(avg_age_non_trick_treater = mean(age, na.rm = TRUE))


```

The average age for someone not going trick or treating is 39.15 years (2dp)

# Question 4
# For each of joy, despair and meh, which candy bar revived the most of these ratings?

```{r}
long_clean_candy_data %>%
  select(candy_bar, ratings) %>% 
  filter(ratings == "JOY") %>% 
  group_by(candy_bar) %>% 
  summarise(ratings_count = n()) %>% 
  arrange(desc(ratings_count)) %>% 
  head(1)
```

```{r}

long_clean_candy_data %>%
  select(candy_bar, ratings) %>% 
  filter(ratings == "DESPAIR") %>% 
  group_by(candy_bar) %>% 
  summarise(ratings_count = n()) %>% 
  arrange(desc(ratings_count)) %>% 
  head(1)

```

```{r}

long_clean_candy_data %>%
  select(candy_bar, ratings) %>% 
  filter(ratings == "MEH") %>% 
  group_by(candy_bar) %>% 
  summarise(ratings_count = n()) %>% 
  arrange(desc(ratings_count)) %>% 
  head(1)

```

```{r}

long_clean_candy_data %>%
  select(ratings) %>% 
  distinct()
  

```

